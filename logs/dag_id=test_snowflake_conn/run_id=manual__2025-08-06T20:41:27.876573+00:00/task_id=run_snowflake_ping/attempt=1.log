[2025-08-06T20:41:30.207+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-08-06T20:41:30.226+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: test_snowflake_conn.run_snowflake_ping manual__2025-08-06T20:41:27.876573+00:00 [queued]>
[2025-08-06T20:41:30.230+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: test_snowflake_conn.run_snowflake_ping manual__2025-08-06T20:41:27.876573+00:00 [queued]>
[2025-08-06T20:41:30.230+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2025-08-06T20:41:30.237+0000] {taskinstance.py:2330} INFO - Executing <Task(SnowflakeOperator): run_snowflake_ping> on 2025-08-06 20:41:27.876573+00:00
[2025-08-06T20:41:30.245+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=3933) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-08-06T20:41:30.245+0000] {standard_task_runner.py:63} INFO - Started process 3936 to run task
[2025-08-06T20:41:30.246+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'test_snowflake_conn', 'run_snowflake_ping', 'manual__2025-08-06T20:41:27.876573+00:00', '--job-id', '71', '--raw', '--subdir', 'DAGS_FOLDER/load/test_snowflake_conn.py', '--cfg-path', '/tmp/tmpplk3ptqp']
[2025-08-06T20:41:30.254+0000] {standard_task_runner.py:91} INFO - Job 71: Subtask run_snowflake_ping
[2025-08-06T20:41:30.342+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-08-06T20:41:30.489+0000] {task_command.py:426} INFO - Running <TaskInstance: test_snowflake_conn.run_snowflake_ping manual__2025-08-06T20:41:27.876573+00:00 [running]> on host 3bffe12d583b
[2025-08-06T20:41:30.571+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='test_snowflake_conn' AIRFLOW_CTX_TASK_ID='run_snowflake_ping' AIRFLOW_CTX_EXECUTION_DATE='2025-08-06T20:41:27.876573+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-08-06T20:41:27.876573+00:00'
[2025-08-06T20:41:30.573+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-08-06T20:41:30.588+0000] {sql.py:276} INFO - Executing: SELECT CURRENT_VERSION();
[2025-08-06T20:41:30.593+0000] {base.py:84} INFO - Using connection ID 'snowflake_conn_id' for task execution.
[2025-08-06T20:41:30.598+0000] {base.py:84} INFO - Using connection ID 'snowflake_conn_id' for task execution.
[2025-08-06T20:41:30.601+0000] {connection.py:399} INFO - Snowflake Connector for Python Version: 3.10.0, Python Version: 3.12.3, Platform: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[2025-08-06T20:41:30.602+0000] {connection.py:1239} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-08-06T20:41:32.615+0000] {connection.py:547} WARNING - Certificate did not match expected hostname: mrc18723.aws_us_east_1.snowflakecomputing.com. Certificate: {'subject': ((('commonName', '*.prod3.us-west-2.snowflakecomputing.com'),),), 'subjectAltName': [('DNS', '*.prod3.us-west-2.snowflakecomputing.com'), ('DNS', '*.us-west-2.snowflakecomputing.com'), ('DNS', '*.global.snowflakecomputing.com'), ('DNS', '*.snowflakecomputing.com'), ('DNS', '*.prod3.us-west-2.aws.snowflakecomputing.com')]}
[2025-08-06T20:41:32.617+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(CertificateError("hostname 'mrc18723.aws_us_east_1.snowflakecomputing.com' doesn't match either of '*.prod3.us-west-2.snowflakecomputing.com', '*.us-west-2.snowflakecomputing.com', '*.global.snowflakecomputing.com', '*.snowflakecomputing.com', '*.prod3.us-west-2.aws.snowflakecomputing.com'"))': /session/v1/login-request?request_id=096fbe3c-4cbf-4b80-9959-bf69c832802d&databaseName=RETAIL_DB&schemaName=RAW&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=5b313681-9961-47c5-b19e-8212a5d9ba1b
[2025-08-06T20:41:32.855+0000] {connection.py:547} WARNING - Certificate did not match expected hostname: mrc18723.aws_us_east_1.snowflakecomputing.com. Certificate: {'subject': ((('commonName', '*.prod3.us-west-2.snowflakecomputing.com'),),), 'subjectAltName': [('DNS', '*.prod3.us-west-2.snowflakecomputing.com'), ('DNS', '*.us-west-2.snowflakecomputing.com'), ('DNS', '*.global.snowflakecomputing.com'), ('DNS', '*.snowflakecomputing.com'), ('DNS', '*.prod3.us-west-2.aws.snowflakecomputing.com')]}
[2025-08-06T20:41:32.863+0000] {network.py:1029} ERROR - Failed to get the response. Hanging? method: post, url: https://mrc18723.AWS_US_EAST_1.snowflakecomputing.com:443/session/v1/login-request?request_id=096fbe3c-4cbf-4b80-9959-bf69c832802d&databaseName=RETAIL_DB&schemaName=RAW&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=5b313681-9961-47c5-b19e-8212a5d9ba1b, headers:{'Content-Type': 'application/json', 'accept': 'application/snowflake', 'User-Agent': 'PythonConnector/3.10.0 (Linux-6.10.14-linuxkit-aarch64-with-glibc2.36) CPython/3.12.3', 'Content-Encoding': 'gzip'}, data: {"data": {"CLIENT_APP_ID": "PythonConnector", "CLIENT_APP_VERSION": "3.10.0", "SVN_REVISION": null, "ACCOUNT_NAME": "mrc18723", "LOGIN_NAME": "Meghashree", "CLIENT_ENVIRONMENT": {"APPLICATION": "AIRFLOW", "OS": "Linux", "OS_VERSION": "Linux-6.10.14-linuxkit-aarch64-with-glibc2.36", "PYTHON_VERSION": "3.12.3", "PYTHON_RUNTIME": "CPython", "PYTHON_COMPILER": "GCC 12.2.0", "OCSP_MODE": "FAIL_OPEN", "TRACING": 20, "LOGIN_TIMEOUT": null, "NETWORK_TIMEOUT": null, "SOCKET_TIMEOUT": null}, "PASSWORD": "**** "SESSION_PARAMETERS": {"CLIENT_PREFETCH_THREADS": 4}}}
[2025-08-06T20:41:34.147+0000] {connection.py:547} WARNING - Certificate did not match expected hostname: mrc18723.aws_us_east_1.snowflakecomputing.com. Certificate: {'subject': ((('commonName', '*.prod3.us-west-2.snowflakecomputing.com'),),), 'subjectAltName': [('DNS', '*.prod3.us-west-2.snowflakecomputing.com'), ('DNS', '*.us-west-2.snowflakecomputing.com'), ('DNS', '*.global.snowflakecomputing.com'), ('DNS', '*.snowflakecomputing.com'), ('DNS', '*.prod3.us-west-2.aws.snowflakecomputing.com')]}
[2025-08-06T20:41:34.149+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(CertificateError("hostname 'mrc18723.aws_us_east_1.snowflakecomputing.com' doesn't match either of '*.prod3.us-west-2.snowflakecomputing.com', '*.us-west-2.snowflakecomputing.com', '*.global.snowflakecomputing.com', '*.snowflakecomputing.com', '*.prod3.us-west-2.aws.snowflakecomputing.com'"))': /session/v1/login-request?request_id=8e1b9abb-199d-4594-ad6d-d8aacbe548cd&databaseName=RETAIL_DB&schemaName=RAW&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=965bef22-af02-47a2-a29e-982a1f7e92af
[2025-08-06T20:41:34.418+0000] {connection.py:547} WARNING - Certificate did not match expected hostname: mrc18723.aws_us_east_1.snowflakecomputing.com. Certificate: {'subject': ((('commonName', '*.prod3.us-west-2.snowflakecomputing.com'),),), 'subjectAltName': [('DNS', '*.prod3.us-west-2.snowflakecomputing.com'), ('DNS', '*.us-west-2.snowflakecomputing.com'), ('DNS', '*.global.snowflakecomputing.com'), ('DNS', '*.snowflakecomputing.com'), ('DNS', '*.prod3.us-west-2.aws.snowflakecomputing.com')]}
[2025-08-06T20:41:34.421+0000] {network.py:1029} ERROR - Failed to get the response. Hanging? method: post, url: https://mrc18723.AWS_US_EAST_1.snowflakecomputing.com:443/session/v1/login-request?request_id=8e1b9abb-199d-4594-ad6d-d8aacbe548cd&databaseName=RETAIL_DB&schemaName=RAW&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=965bef22-af02-47a2-a29e-982a1f7e92af, headers:{'Content-Type': 'application/json', 'accept': 'application/snowflake', 'User-Agent': 'PythonConnector/3.10.0 (Linux-6.10.14-linuxkit-aarch64-with-glibc2.36) CPython/3.12.3', 'Content-Encoding': 'gzip'}, data: {"data": {"CLIENT_APP_ID": "PythonConnector", "CLIENT_APP_VERSION": "3.10.0", "SVN_REVISION": null, "ACCOUNT_NAME": "mrc18723", "LOGIN_NAME": "Meghashree", "CLIENT_ENVIRONMENT": {"APPLICATION": "AIRFLOW", "OS": "Linux", "OS_VERSION": "Linux-6.10.14-linuxkit-aarch64-with-glibc2.36", "PYTHON_VERSION": "3.12.3", "PYTHON_RUNTIME": "CPython", "PYTHON_COMPILER": "GCC 12.2.0", "OCSP_MODE": "FAIL_OPEN", "TRACING": 20, "LOGIN_TIMEOUT": null, "NETWORK_TIMEOUT": null, "SOCKET_TIMEOUT": null}, "PASSWORD": "**** "SESSION_PARAMETERS": {"CLIENT_PREFETCH_THREADS": 4}}}
[2025-08-06T20:41:34.424+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-08-06T20:41:34.425+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1373, in _authenticate
    auth.authenticate(
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/auth/_auth.py", line 250, in authenticate
    ret = self._rest._post_request(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/network.py", line 734, in _post_request
    ret = self.fetch(
          ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/network.py", line 843, in fetch
    ret = self._request_exec_wrapper(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/network.py", line 979, in _request_exec_wrapper
    raise e
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/network.py", line 895, in _request_exec_wrapper
    self._handle_unknown_error(method, full_url, headers, data, conn)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/network.py", line 1034, in _handle_unknown_error
    Error.errorhandler_wrapper(
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 348, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.OperationalError: 250003: 250003: Failed to get the response. Hanging? method: post, url: https://mrc18723.AWS_US_EAST_1.snowflakecomputing.com:443/session/v1/login-request?request_id=096fbe3c-4cbf-4b80-9959-bf69c832802d&databaseName=RETAIL_DB&schemaName=RAW&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=5b313681-9961-47c5-b19e-8212a5d9ba1b

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/operators/sql.py", line 282, in execute
    output = hook.run(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 389, in run
    with closing(self.get_conn()) as conn:
                 ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 287, in get_conn
    conn = connector.connect(**conn_config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/__init__.py", line 55, in Connect
    return SnowflakeConnection(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 442, in __init__
    self.connect(**kwargs)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 745, in connect
    self.__open_connection()
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1073, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1345, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1417, in _authenticate
    raise auth_op from e
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1394, in _authenticate
    auth_instance.handle_timeout(
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/auth/by_plugin.py", line 212, in handle_timeout
    raise error
snowflake.connector.errors.OperationalError: 250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[2025-08-06T20:41:34.448+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=test_snowflake_conn, task_id=run_snowflake_ping, run_id=manual__2025-08-06T20:41:27.876573+00:00, execution_date=20250806T204127, start_date=20250806T204130, end_date=20250806T204134
[2025-08-06T20:41:34.466+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 71 for task run_snowflake_ping (250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting; 3936)
[2025-08-06T20:41:34.512+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-08-06T20:41:34.537+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-08-06T20:41:34.537+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
